{"ast":null,"code":"// frontend/src/App.js\nimport React,{useState,useEffect}from'react';import io from'socket.io-client';import Login from'./components/Login';import Register from'./components/Register';import Chat from'./components/Chat';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE='http://localhost:5000';function App(){const[user,setUser]=useState(null);const[token,setToken]=useState(localStorage.getItem('token'));const[currentView,setCurrentView]=useState('login');const[socket,setSocket]=useState(null);useEffect(()=>{if(token){// Verify token is still valid\nfetch(`${API_BASE}/api/users`,{headers:{'Authorization':`Bearer ${token}`}}).then(response=>{if(response.ok){const userData=JSON.parse(localStorage.getItem('user'));setUser(userData);// Initialize socket connection\nconst newSocket=io(API_BASE);setSocket(newSocket);if(userData){newSocket.emit('join_room',userData.id);}}else{localStorage.removeItem('token');localStorage.removeItem('user');setToken(null);}}).catch(error=>{console.error('Token verification failed:',error);localStorage.removeItem('token');localStorage.removeItem('user');setToken(null);});}},[token]);const handleLogin=(userData,userToken)=>{setUser(userData);setToken(userToken);localStorage.setItem('token',userToken);localStorage.setItem('user',JSON.stringify(userData));// Initialize socket connection\nconst newSocket=io(API_BASE);setSocket(newSocket);newSocket.emit('join_room',userData.id);};const handleLogout=()=>{if(socket){socket.disconnect();}setUser(null);setToken(null);setSocket(null);localStorage.removeItem('token');localStorage.removeItem('user');};if(user&&socket){return/*#__PURE__*/_jsx(Chat,{user:user,token:token,socket:socket,onLogout:handleLogout});}return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"auth-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Termiclad\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Connect and chat with your friends\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-tabs\",children:[/*#__PURE__*/_jsx(\"button\",{className:currentView==='login'?'active':'',onClick:()=>setCurrentView('login'),children:\"Login\"}),/*#__PURE__*/_jsx(\"button\",{className:currentView==='register'?'active':'',onClick:()=>setCurrentView('register'),children:\"Register\"})]}),currentView==='login'?/*#__PURE__*/_jsx(Login,{onLogin:handleLogin}):/*#__PURE__*/_jsx(Register,{onRegister:handleLogin})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","io","Login","Register","Chat","jsx","_jsx","jsxs","_jsxs","API_BASE","App","user","setUser","token","setToken","localStorage","getItem","currentView","setCurrentView","socket","setSocket","fetch","headers","then","response","ok","userData","JSON","parse","newSocket","emit","id","removeItem","catch","error","console","handleLogin","userToken","setItem","stringify","handleLogout","disconnect","onLogout","className","children","onClick","onLogin","onRegister"],"sources":["C:/Users/maogr/Desktop/Termiclad/frontend/src/App.js"],"sourcesContent":["// frontend/src/App.js\nimport React, { useState, useEffect } from 'react';\nimport io from 'socket.io-client';\nimport Login from './components/Login';\nimport Register from './components/Register';\nimport Chat from './components/Chat';\nimport './App.css';\n\nconst API_BASE = 'http://localhost:5000';\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem('token'));\n  const [currentView, setCurrentView] = useState('login');\n  const [socket, setSocket] = useState(null);\n\n  useEffect(() => {\n    if (token) {\n      // Verify token is still valid\n      fetch(`${API_BASE}/api/users`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      })\n        .then(response => {\n          if (response.ok) {\n            const userData = JSON.parse(localStorage.getItem('user'));\n            setUser(userData);\n\n            // Initialize socket connection\n            const newSocket = io(API_BASE);\n            setSocket(newSocket);\n\n            if (userData) {\n              newSocket.emit('join_room', userData.id);\n            }\n          } else {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            setToken(null);\n          }\n        })\n        .catch(error => {\n          console.error('Token verification failed:', error);\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          setToken(null);\n        });\n    }\n  }, [token]);\n\n  const handleLogin = (userData, userToken) => {\n    setUser(userData);\n    setToken(userToken);\n    localStorage.setItem('token', userToken);\n    localStorage.setItem('user', JSON.stringify(userData));\n\n    // Initialize socket connection\n    const newSocket = io(API_BASE);\n    setSocket(newSocket);\n    newSocket.emit('join_room', userData.id);\n  };\n\n  const handleLogout = () => {\n    if (socket) {\n      socket.disconnect();\n    }\n    setUser(null);\n    setToken(null);\n    setSocket(null);\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n  };\n\n  if (user && socket) {\n    return <Chat user={user} token={token} socket={socket} onLogout={handleLogout} />;\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"auth-container\">\n        <div className=\"auth-header\">\n          <h1>Termiclad</h1>\n          <p>Connect and chat with your friends</p>\n        </div>\n\n        <div className=\"auth-tabs\">\n          <button\n            className={currentView === 'login' ? 'active' : ''}\n            onClick={() => setCurrentView('login')}\n          >\n            Login\n          </button>\n          <button\n            className={currentView === 'register' ? 'active' : ''}\n            onClick={() => setCurrentView('register')}\n          >\n            Register\n          </button>\n        </div>\n\n        {currentView === 'login' ? (\n          <Login onLogin={handleLogin} />\n        ) : (\n          <Register onRegister={handleLogin} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}